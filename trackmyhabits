from datetime import datetime

# Função para carregar os hábitos do arquivo
def carregar_habitos():
    try:
        with open('habitos.txt', 'r') as arquivo:
            habitos = [linha.strip() for linha in arquivo.readlines()]
    except FileNotFoundError:
        habitos = []
    return habitos

# Função para salvar os hábitos no arquivo
def salvar_habitos(habitos):
    with open('habitos.txt', 'w') as arquivo:
        for habito in habitos:
            arquivo.write(habito + '\n')

# Função para adicionar novos hábitos
def adicionar_habito(habitos):
    novo_habito = input("Digite o novo hábito que deseja rastrear: ")
    habitos.append(novo_habito)
    salvar_habitos(habitos)
    print(f'Hábito "{novo_habito}" adicionado com sucesso!')

# Função para marcar hábitos como concluídos
def marcar_habito(habitos):
    for i, habito in enumerate(habitos):
        print(f'{i + 1}. {habito}')
    escolha = int(input("Selecione o número do hábito concluído hoje: ")) - 1
    
    with open('historico.txt', 'a') as historico:
        historico.write(f'{habitos[escolha]} - concluído no dia {obter_data()}\n')

    print(f'Hábito "{habitos[escolha]}" marcado como concluído hoje!')

# Função para visualizar o histórico de hábitos concluídos
def visualizar_historico():
    try:
        with open('historico.txt', 'r') as historico:
            print(historico.read())
    except FileNotFoundError:
        print("Nenhum histórico encontrado.")

# Função utilitária para obter a data atual
def obter_data():
    return datetime.now().strftime('%d/%m/%Y')

# Função principal do menu
def exibir_menu():
    habitos = carregar_habitos()
    while True:
        print("\n1. Adicionar hábito\n2. Marcar hábito como concluído\n3. Visualizar histórico\n4. Sair")
        escolha = input("Escolha uma opção: ")

        if escolha == '1':
            adicionar_habito(habitos)
        elif escolha == '2':
            marcar_habito(habitos)
        elif escolha == '3':
            visualizar_historico()
        elif escolha == '4':
            print("Saindo do programa. Até a próxima!")
            break
        else:
            print("Opção inválida! Tente novamente.")

if __name__ == '__main__':
    exibir_menu()
